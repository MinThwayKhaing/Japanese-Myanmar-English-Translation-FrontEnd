{"version":3,"file":"wordService.js","sourceRoot":"","sources":["../../src/services/wordService.ts"],"names":[],"mappings":"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","sourcesContent":["import axiosInstance from './axiosInstance';\r\nimport { API_BASE_URL } from '../config';\r\n\r\nexport interface Word {\r\n  _id?: string;\r\n  english: string;\r\n  japanese?: string;\r\n  myanmar?: string;\r\n  subTerm?: string;\r\n  createdAt?: string;\r\n  updatedAt?: string;\r\n  totalCount?: number;\r\n}\r\nexport type RNFile = {\r\n  uri: string;\r\n  name: string;\r\n  type: string;\r\n};\r\nexport interface PaginatedWords {\r\n  totalCount: number;\r\n  words: Word[];\r\n  hasMore: boolean;\r\n  currentPage: number;\r\n}\r\n\r\nexport const WordService = {\r\n  // Search words by query\r\n  searchWords: async (query: string, token?: string): Promise<Word[]> => {\r\n    try {\r\n      const res = await axiosInstance.get(`${API_BASE_URL}/words/search`, {\r\n        params: { q: query },\r\n        headers: token ? { Authorization: `Bearer ${token}` } : undefined,\r\n      });\r\n      if (Array.isArray(res.data)) return res.data;\r\n      if (res.data?.words) return res.data.words;\r\n      return [];\r\n    } catch (err) {\r\n      console.error('Error in searchWords:', err);\r\n      return [];\r\n    }\r\n  },\r\n\r\n  getWordByID: async (id: string, token?: string): Promise<Word> => {\r\n    const res = await axiosInstance.get(`${API_BASE_URL}/words/${id}`, {\r\n      headers: token ? { Authorization: `Bearer ${token}` } : undefined,\r\n    });\r\n    return res.data;\r\n  },\r\n\r\n  // New: Select one word (shared user/admin)\r\n  selectOneWord: async (id: string, token?: string): Promise<Word> => {\r\n    const res = await axiosInstance.get(`${API_BASE_URL}/words/selectone/${id}`, {\r\n      headers: token ? { Authorization: `Bearer ${token}` } : undefined,\r\n    });\r\n    return res.data;\r\n  },\r\n\r\n  getAllWords: async (page = 1, limit = 15, query = '', token?: string): Promise<PaginatedWords> => {\r\n    const res = await axiosInstance.get(`${API_BASE_URL}/words`, {\r\n      params: { page, limit, q: query },\r\n      headers: token ? { Authorization: `Bearer ${token}` } : undefined,\r\n    });\r\n    return res.data;\r\n  },\r\n\r\n  createWord: async (word: Word, token: string): Promise<Word> => {\r\n    const res = await axiosInstance.post(`${API_BASE_URL}/words`, word, {\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    });\r\n    return res.data;\r\n  },\r\n\r\n  updateWord: async (id: string, word: Word, token: string): Promise<Word> => {\r\n    const res = await axiosInstance.put(`${API_BASE_URL}/words/${id}`, word, {\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    });\r\n    return res.data;\r\n  },\r\n\r\n  deleteWord: async (id: string, token: string): Promise<void> => {\r\n    console.log('Deleting word with ID:', id);\r\n    await axiosInstance.delete(`${API_BASE_URL}/words/${id}`, {\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    });\r\n  },\r\n\r\n    // New: Upload Excel file to create words\r\n  uploadExcelWords: async (file: {\r\n      uri: string;\r\n      name: string;\r\n      type: string;\r\n      content?: string; // base64 content\r\n    }, token: string): Promise<{ message: string }> => {\r\n      \r\n      if (file.content) {\r\n        // Method 1: Upload as base64\r\n        const res = await axiosInstance.post(\r\n          `${API_BASE_URL}/words/excel-upload-base64`,\r\n          {\r\n            fileName: file.name,\r\n            fileData: file.content,\r\n            fileType: file.type,\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${token}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            timeout: 60000,\r\n          }\r\n        );\r\n        return res.data;\r\n      } else {\r\n        // Method 2: Fallback to FormData (for backward compatibility)\r\n        const formData = new FormData();\r\n        formData.append('file', {\r\n          uri: file.uri,\r\n          name: file.name || 'words.xlsx',\r\n          type: file.type || 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n        } as any);\r\n\r\n        const res = await axiosInstance.post(\r\n          `${API_BASE_URL}/words/excel-upload`,\r\n          formData,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${token}`,\r\n              'Content-Type': 'multipart/form-data',\r\n            },\r\n            timeout: 60000,\r\n          }\r\n        );\r\n        return res.data;\r\n      }\r\n    },\r\n};\r\n"]}