{"version":3,"file":"FavouriteScreen.js","sourceRoot":"","sources":["../../src/screens/FavouriteScreen.tsx"],"names":[],"mappings":"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","sourcesContent":["// src/screens/FavouriteScreen.tsx\r\nimport React, { useEffect, useState,useCallback  } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  FlatList,\r\n  TouchableOpacity,\r\n  StyleSheet,\r\n  ActivityIndicator,\r\n  StatusBar,\r\n  Platform,\r\n} from 'react-native';\r\nimport { SafeAreaView } from 'react-native-safe-area-context';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { UserService } from '../services/UserService';\r\nimport { useFocusEffect } from '@react-navigation/native';\r\nimport { Colors } from '../constants/colors';\r\nconst PAGE_LIMIT = 10;\r\n\r\nconst FavouriteScreen = () => {\r\n  const navigation = useNavigation<any>();\r\n  const [favorites, setFavorites] = useState<any[]>([]);\r\n  const [page, setPage] = useState(1);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingMore, setLoadingMore] = useState(false);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [token, setToken] = useState<string | null>(null);\r\n    const loadFavorites = async () => {\r\n    setLoading(true);\r\n    const token = await AsyncStorage.getItem('token');\r\n    if (!token) {\r\n      setFavorites([]);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const data = await UserService.getFavorites(token);\r\n      setFavorites(data || []);\r\n    } catch (err) {\r\n      console.error('Error loading favorites:', err);\r\n      setFavorites([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  useFocusEffect(\r\n    useCallback(() => {\r\n      loadFavorites();\r\n    }, [])\r\n  );\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      const storedToken = await AsyncStorage.getItem('token');\r\n      if (!storedToken) return;\r\n      setToken(storedToken);\r\n      fetchFavorites(storedToken, 1);\r\n    };\r\n    init();\r\n  }, []);\r\n\r\n  const fetchFavorites = async (token: string, pageNumber: number) => {\r\n    try {\r\n      if (pageNumber === 1) setLoading(true);\r\n      else setLoadingMore(true);\r\n\r\n      const data = await UserService.getFavoritesPaginated(pageNumber, PAGE_LIMIT, token);\r\n      const newFavs = Array.isArray(data.favorites) ? data.favorites : [];\r\n\r\n      setFavorites(pageNumber === 1 ? newFavs : [...favorites, ...newFavs]);\r\n      setHasMore(data.hasMore);\r\n    } catch (err) {\r\n      console.error('Failed to load favorites:', err);\r\n    } finally {\r\n      setLoading(false);\r\n      setLoadingMore(false);\r\n    }\r\n  };\r\n\r\n  const loadMore = () => {\r\n    if (!hasMore || loadingMore || !token) return;\r\n    const nextPage = page + 1;\r\n    setPage(nextPage);\r\n    fetchFavorites(token, nextPage);\r\n  };\r\n\r\n  const removeFavorite = async (wordId: string) => {\r\n    if (!token) return;\r\n    try {\r\n      await UserService.removeFavorite(wordId, token);\r\n      setFavorites((prev) => prev.filter((item) => item.id !== wordId));\r\n    } catch (err) {\r\n      console.error('Failed to remove favorite:', err);\r\n    }\r\n  };\r\n\r\n  const renderItem = ({ item }: any) => (\r\n    <View style={styles.wordRow}>\r\n      <TouchableOpacity\r\n        style={styles.wordContainer}\r\n        activeOpacity={0.7}\r\n        onPress={() => navigation.navigate('UserWordDetail', { id: item.id })}\r\n      >\r\n        <Text style={styles.japaneseText}>\r\n          {item.japanese}\r\n          {item.subTerm ? <Text style={styles.subTermText}>（{item.subTerm}）</Text> : null}\r\n        </Text>\r\n        {item.myanmar && <Text style={styles.myanmarText}>{item.myanmar}</Text>}\r\n        {item.english && <Text style={styles.englishText}>{item.english}</Text>}\r\n      </TouchableOpacity>\r\n\r\n      <TouchableOpacity onPress={() => removeFavorite(item.id)}>\r\n        <Ionicons name=\"heart\" size={24} color=\"red\" />\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n\r\n  return (\r\n    <SafeAreaView style={styles.safeContainer}>\r\n      <StatusBar barStyle=\"dark-content\" backgroundColor=\"#fff\" />\r\n      <View style={styles.header}>\r\n        <Text style={styles.headerText}>Favourite Words</Text>\r\n      </View>\r\n\r\n      {loading && page === 1 ? (\r\n        <ActivityIndicator size=\"large\" color=\"#1A374D\" style={{ marginTop: 30 }} />\r\n      ) : favorites.length === 0 ? (\r\n        <Text style={styles.emptyText}>You haven’t added any favorites yet.</Text>\r\n      ) : (\r\n        <FlatList\r\n          data={favorites}\r\n          renderItem={renderItem}\r\n          keyExtractor={(item) => item.id}\r\n          onEndReached={loadMore}\r\n          onEndReachedThreshold={0.5}\r\n          ListFooterComponent={loadingMore ? <ActivityIndicator size=\"small\" color=\"#1A374D\" /> : null}\r\n          ItemSeparatorComponent={() => <View style={styles.separator} />}\r\n          contentContainerStyle={{ paddingBottom: 40 }}\r\n        />\r\n      )}\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nexport default FavouriteScreen;\r\n\r\nconst styles = StyleSheet.create({\r\n  safeContainer: {\r\n    flex: 1,\r\n    backgroundColor:  Colors.background,\r\n    paddingHorizontal: 16,\r\n    paddingTop: Platform.OS === 'android' ? 0 : 0,\r\n  },\r\n  header: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  headerText: {\r\n    fontSize: 22,\r\n    fontWeight: 'bold',\r\n    color: '#1A374D',\r\n  },\r\n  wordRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 8,\r\n    alignItems: 'center',\r\n  },\r\n  wordContainer: { flex: 1 },\r\n  japaneseText: { fontSize: 22, fontWeight: 'bold', color: '#1A374D' },\r\n  subTermText: { fontSize: 16, color: '#666', fontWeight: '400' },\r\n  myanmarText: { fontSize: 18, color: '#333', marginTop: 4 },\r\n  englishText: { fontSize: 16, color: '#555', marginTop: 2 },\r\n  separator: { height: 1, backgroundColor: '#DDD', marginHorizontal: 8 },\r\n  emptyText: { textAlign: 'center', color: '#888', marginTop: 40, fontSize: 16 },\r\n});\r\n"]}