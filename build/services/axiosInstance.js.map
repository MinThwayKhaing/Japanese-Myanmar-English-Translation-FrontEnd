{"version":3,"file":"axiosInstance.js","sourceRoot":"","sources":["../../src/services/axiosInstance.ts"],"names":[],"mappings":"AAAA,mBAAmB;AACnB,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,EAAE,YAAY,EAAE,MAAM,WAAW,CAAC;AACzC,OAAO,EAAE,KAAK,EAAE,MAAM,cAAc,CAAC;AACrC,OAAO,YAAY,MAAM,2CAA2C,CAAC;AAErE,IAAI,cAAc,GAAiC,IAAI,CAAC;AAExD,MAAM,CAAC,MAAM,gBAAgB,GAAG,CAAC,QAA6B,EAAE,EAAE;IAChE,cAAc,GAAG,QAAQ,CAAC;AAC5B,CAAC,CAAC;AAEF,MAAM,QAAQ,GAAG,KAAK,CAAC,MAAM,CAAC;IAC5B,OAAO,EAAE,YAAY;CACtB,CAAC,CAAC;AAEH,QAAQ,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAChC,QAAQ,CAAC,EAAE,CAAC,QAAQ,EACpB,KAAK,EAAC,KAAK,EAAC,EAAE;IACZ,IAAI,KAAK,CAAC,QAAQ,EAAE,MAAM,KAAK,GAAG,EAAE,CAAC;QACnC,MAAM,YAAY,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QACvC,MAAM,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAEtC,KAAK,CAAC,KAAK,CAAC,iBAAiB,EAAE,sBAAsB,CAAC,CAAC;QAEvD,uCAAuC;QACvC,IAAI,cAAc,EAAE,CAAC;YACnB,MAAM,cAAc,EAAE,CAAC;QACzB,CAAC;QACK,OAAO,IAAI,OAAO,CAAC,GAAG,EAAE,GAAE,CAAC,CAAC,CAAC;IACrC,CAAC;IACD,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AAC/B,CAAC,CACF,CAAC;AAEF,eAAe,QAAQ,CAAC","sourcesContent":["// axiosInstance.ts\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config';\r\nimport { Alert } from 'react-native';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nlet logoutCallback: (() => Promise<void>) | null = null;\r\n\r\nexport const setLogoutHandler = (callback: () => Promise<void>) => {\r\n  logoutCallback = callback;\r\n};\r\n\r\nconst instance = axios.create({\r\n  baseURL: API_BASE_URL,\r\n});\r\n\r\ninstance.interceptors.response.use(\r\n  response => response,\r\n  async error => {\r\n    if (error.response?.status === 401) {\r\n      await AsyncStorage.removeItem('token');\r\n      await AsyncStorage.removeItem('role');\r\n\r\n      Alert.alert('Session expired', 'Please log in again.');\r\n\r\n      // Call the logout callback if provided\r\n      if (logoutCallback) {\r\n        await logoutCallback();\r\n      }\r\n            return new Promise(() => {}); \r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default instance;\r\n"]}